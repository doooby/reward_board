(()=>{var t={96:(t,e,i)=>{var r="Expected a function",n=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,a=/^0o[0-7]+$/i,u=parseInt,c="object"==typeof i.g&&i.g&&i.g.Object===Object&&i.g,l="object"==typeof self&&self&&self.Object===Object&&self,f=c||l||Function("return this")(),v=Object.prototype.toString,h=Math.max,p=Math.min,d=function(){return f.Date.now()};function S(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function w(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==v.call(t)}(t))return NaN;if(S(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=S(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(n,"");var i=s.test(t);return i||a.test(t)?u(t.slice(2),i?2:8):o.test(t)?NaN:+t}t.exports=function(t,e,i){var n=!0,o=!0;if("function"!=typeof t)throw new TypeError(r);return S(i)&&(n="leading"in i?!!i.leading:n,o="trailing"in i?!!i.trailing:o),function(t,e,i){var n,o,s,a,u,c,l=0,f=!1,v=!1,y=!0;if("function"!=typeof t)throw new TypeError(r);function M(e){var i=n,r=o;return n=o=void 0,l=e,a=t.apply(r,i)}function m(t){return l=t,u=setTimeout(E,e),f?M(t):a}function _(t){var i=t-c;return void 0===c||i>=e||i<0||v&&t-l>=s}function E(){var t=d();if(_(t))return g(t);u=setTimeout(E,function(t){var i=e-(t-c);return v?p(i,s-(t-l)):i}(t))}function g(t){return u=void 0,y&&n?M(t):(n=o=void 0,a)}function P(){var t=d(),i=_(t);if(n=arguments,o=this,c=t,i){if(void 0===u)return m(c);if(v)return u=setTimeout(E,e),M(c)}return void 0===u&&(u=setTimeout(E,e)),a}return e=w(e)||0,S(i)&&(f=!!i.leading,s=(v="maxWait"in i)?h(w(i.maxWait)||0,e):s,y="trailing"in i?!!i.trailing:y),P.cancel=function(){void 0!==u&&clearTimeout(u),l=0,n=c=o=u=void 0},P.flush=function(){return void 0===u?a:g(d())},P}(t,e,{leading:n,maxWait:e,trailing:o})}},450:function(t,e,i){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var n=i(134),o=r(i(96)),s=function(){function t(t){var e=this;this.mouseOverPosition=null,this.canvasCtx=null,this.currentModel=null,this.currentSizes=null,this.onMouseMove=o.default((function(t){var i=e.mouseOverPosition;if(t.stopPropagation(),e.currentModel&&e.currentSizes){var r=e.currentSizes.slot,o=e.currentModel.viewSize/2,s=e.canvas.getBoundingClientRect(),a=Math.floor((t.clientX-s.x-o+r/2)/e.currentSizes.slot),u=Math.floor((t.clientY-s.y-o+r/2)/e.currentSizes.slot),c=new n.Position(a,u);c.isOnBoard()?(null==i?void 0:i.x)===c.x&&(null==i?void 0:i.y)===c.y||(e.mouseOverPosition=c):e.mouseOverPosition=null,i!==e.mouseOverPosition&&e.onMouseMoveCallback(e.mouseOverPosition||void 0)}}),400),this.onMouseMoveCallback=t,this.wrapper=document.createElement("div"),this.wrapper.classList.add("wrapper"),this.canvas=document.createElement("canvas"),this.resetCanvas(0),this.canvas.addEventListener("mousemove",this.onMouseMove),this.wrapper.appendChild(this.canvas)}return t.prototype.attach=function(t){t.appendChild(this.wrapper)},t.prototype.render=function(t){this.currentModel=t,t.viewSize===this.canvas.width&&t.viewSize===this.canvas.height||this.resetCanvas(t.viewSize);var e=this.canvasCtx;if(null!==e){e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.viewSize,t.viewSize),this.currentSizes={view:t.viewSize,slot:l(2.52,t.viewSize),stepMargin:l(0,t.viewSize),step:l(2.52,t.viewSize),stepBorder:l(.21000000000000002,t.viewSize),avatar:l(2.1,t.viewSize)},e.lineWidth=this.currentSizes.stepBorder,e.strokeStyle="black";for(var i=0,r=n.mapTiles;i<r.length;i++)a(e,r[i],this.currentSizes);for(var o=0,s=t.rewards;o<s.length;o++)u(e,s[o],this.currentSizes);t.avatarPosition&&function(t,e,i){var r=i.avatar,n=c(e,i),o=n[0],s=n[1];t.fillStyle="orange",t.setTransform(1,0,0,1,o-r/2,s-r/2),t.fillRect(0,0,r,r)}(e,t.avatarPosition,this.currentSizes)}},t.prototype.resetCanvas=function(t){this.canvas.width=t,this.canvas.height=t,this.canvasCtx=this.canvas.getContext("2d"),null!==this.canvasCtx&&(this.canvasCtx.imageSmoothingEnabled=!1)},t}();function a(t,e,i){var r=i.slot,n=i.stepMargin,o=i.step,s=c(e,i),a=s[0],u=s[1];t.setTransform(1,0,0,1,a-r/2,u-r/2),t.strokeRect(n,n,o,o)}function u(t,e,i){var r=i.avatar,n=c(e,i),o=n[0],s=n[1];t.fillStyle=e.style.color,t.setTransform(1,0,0,1,o-r/2,s-r/2),t.fillRect(0,0,r,r)}function c(t,e){var i=e.view,r=e.slot;return[i/2+t.x*r,i/2+t.y*r]}function l(t,e){return Math.ceil(t/100*e)}e.default=s},629:function(t,e,i){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=i(134),s=n(i(450));globalThis.D3O_RewardBoard=function(){function t(t){var e=this;this.model={viewSize:0,avatarPosition:null,rewards:[]},this.onMouseMove=function(t){var i,r,n=t&&e.model.rewards.find((function(e){var i=e.x,r=e.y;return i===t.x&&r===t.y}));null===(r=(i=e.config).onMouseOverReward)||void 0===r||r.call(i,n)},this.config=t,this.view=new s.default(this.onMouseMove),this.view.attach(t.element.attachShadow({mode:"closed"})),this.updateModel(r(r({},this.model),{avatarPosition:o.Position.parse(t.position),rewards:Object.freeze(t.rewards.slice(0))})),new ResizeObserver((function(t){try{var i=t[0].contentRect.width;e.updateModel(r(r({},e.model),{viewSize:i}))}finally{}})).observe(this.view.wrapper)}return t.prototype.updateModel=function(t){this.model=t,this.view.render(this.model)},t.prototype.possibleSteps=function(){var t=this.model.avatarPosition;return t?t.possibleSteps():{up:!1,right:!1,down:!1,left:!1}},t.prototype.step=function(t){var e=this,i=this.model.avatarPosition;if(i){var r=i.step(t);if(r&&r.isOnBoard()){var n=this.model.rewards.find((function(t){var e=t.x,i=t.y;return e===r.x&&i===r.y}));setTimeout((function(){var t,i;return null===(i=(t=e.config).onStepRequested)||void 0===i?void 0:i.call(t,r,n)}),0)}}},t.prototype.setPosition=function(t){var e=o.Position.parse(t);this.updateModel(r(r({},this.model),{avatarPosition:e}))},t}()},134:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.mapTiles=e.Position=e.RIM_LAS_LEVEL_STEPS=e.RIM_STEPS=e.RIMS_LEVELS=void 0,e.RIMS_LEVELS=4,e.RIM_STEPS=3,e.RIM_LAS_LEVEL_STEPS=8;var i=function(){function t(t,e){if("number"!=typeof t||isNaN(t)||"number"!=typeof e||isNaN(e))throw new Error("en.Position.invalid");this.x=t,this.y=e,Object.freeze(this)}return t.parse=function(e){if(!e)return null;try{return new t(e.x,e.y)}catch(t){return console.error("D3O_RewardBoard invalid position:",e),console.error(t),null}},t.prototype.distance=function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},t.prototype.isOnBoard=function(){var t=0===this.x,i=0===this.y;if(t&&i)return!0;var r=Math.abs(this.x),n=Math.abs(this.y);if(t||i)return(t?n:r)<=e.RIMS_LEVELS*e.RIM_STEPS-e.RIM_STEPS+e.RIM_LAS_LEVEL_STEPS;if(r%e.RIM_STEPS==0||n%e.RIM_STEPS==0){var o=[r,n].sort((function(t,e){return t-e})),s=o[0],a=o[1],u=a%e.RIM_STEPS==0,c=u?a/e.RIM_STEPS:s/e.RIM_STEPS;return!(c>e.RIMS_LEVELS)&&(u?s:a)<=c*e.RIM_STEPS}return!1},t.prototype.possibleSteps=function(){return{up:this.step("up").isOnBoard(),right:this.step("right").isOnBoard(),down:this.step("down").isOnBoard(),left:this.step("left").isOnBoard()}},t.prototype.step=function(e){switch(e){case"up":return new t(this.x,this.y-1);case"right":return new t(this.x+1,this.y);case"down":return new t(this.x,this.y+1);case"left":return new t(this.x-1,this.y)}},t}();function r(t,i){e.mapTiles.push({x:t,y:i})}e.Position=i,e.mapTiles=[],r(0,0);for(var n=e.RIMS_LEVELS*e.RIM_STEPS+e.RIM_LAS_LEVEL_STEPS-e.RIM_STEPS,o=-n;o<=n;o+=1)0!==o&&(r(o,0),r(0,o));for(var s=0;s<e.RIMS_LEVELS;s+=1){var a=s*e.RIM_STEPS+e.RIM_STEPS;for(o=-a;o<a;o+=1)0!==o&&(r(o,-a),r(a,o),r(o,a),r(-a,o));r(a,-a),r(a,a),r(-a,a),r(-a,-a)}}},e={};function i(r){var n=e[r];if(void 0!==n)return n.exports;var o=e[r]={exports:{}};return t[r].call(o.exports,o,o.exports,i),o.exports}i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i(629)})();