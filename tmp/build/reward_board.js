(()=>{var t={96:(t,e,n)=>{var i="Expected a function",o=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,s=/^0o[0-7]+$/i,u=parseInt,l="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,c="object"==typeof self&&self&&self.Object===Object&&self,f=l||c||Function("return this")(),h=Object.prototype.toString,d=Math.max,p=Math.min,v=function(){return f.Date.now()};function y(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function S(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==h.call(t)}(t))return NaN;if(y(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=y(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(o,"");var n=a.test(t);return n||s.test(t)?u(t.slice(2),n?2:8):r.test(t)?NaN:+t}t.exports=function(t,e,n){var o=!0,r=!0;if("function"!=typeof t)throw new TypeError(i);return y(n)&&(o="leading"in n?!!n.leading:o,r="trailing"in n?!!n.trailing:r),function(t,e,n){var o,r,a,s,u,l,c=0,f=!1,h=!1,b=!0;if("function"!=typeof t)throw new TypeError(i);function w(e){var n=o,i=r;return o=r=void 0,c=e,s=t.apply(i,n)}function M(t){return c=t,u=setTimeout(g,e),f?w(t):s}function _(t){var n=t-l;return void 0===l||n>=e||n<0||h&&t-c>=a}function g(){var t=v();if(_(t))return m(t);u=setTimeout(g,function(t){var n=e-(t-l);return h?p(n,a-(t-c)):n}(t))}function m(t){return u=void 0,b&&o?w(t):(o=r=void 0,s)}function P(){var t=v(),n=_(t);if(o=arguments,r=this,l=t,n){if(void 0===u)return M(l);if(h)return u=setTimeout(g,e),w(l)}return void 0===u&&(u=setTimeout(g,e)),s}return e=S(e)||0,y(n)&&(f=!!n.leading,a=(h="maxWait"in n)?d(S(n.maxWait)||0,e):a,b="trailing"in n?!!n.trailing:b),P.cancel=function(){void 0!==u&&clearTimeout(u),c=0,o=l=r=u=void 0},P.flush=function(){return void 0===u?s:m(v())},P}(t,e,{leading:o,maxWait:e,trailing:r})}},336:function(t,e,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var r=o(n(570)),a=o(n(450)),s=o(n(765)),u=function(){function t(t){var e=this;this.model={viewSize:0,avatarPosition:null,avatarColor:"blue",rewards:[]},this.onPositionClicked=function(t){var n,i;null===(i=(n=e.config).onPositionClick)||void 0===i||i.call(n,t)},this.onMouseMove=function(t){var n,i;null===(i=(n=e.config).onMouseOverPosition)||void 0===i||i.call(n,t)},this.config=t,this.view=new a.default({onPositionClick:this.onPositionClicked,onMouseMove:this.onMouseMove}),this.view.attach(t.element.attachShadow({mode:"closed"})),this.updateModel({avatarPosition:r.default.parse(t.defaultPosition),avatarColor:t.avatarColor||this.model.avatarColor,rewards:Object.freeze(t.rewards.slice(0))}),new ResizeObserver((function(t){try{var n=t[0].contentRect.width;e.updateModel({viewSize:n})}finally{}})).observe(this.view.wrapper)}return t.prototype.updateModel=function(t){this.model=i(i({},this.model),t),this.view.render(this.model)},t.prototype.possibleSteps=function(){var t=this.model.avatarPosition;return t?t.possibleSteps():{up:!1,right:!1,down:!1,left:!1}},t.prototype.step=function(t){var e=this,n=this.model.avatarPosition;if(n){var i=n.step(t);i&&i.isOnBoard()&&setTimeout((function(){var t,n;return null===(n=(t=e.config).onStepRequested)||void 0===n?void 0:n.call(t,i)}),0)}},t.prototype.setPosition=function(t){var e=r.default.parse(t);this.updateModel({avatarPosition:e})},t.prototype.setRewards=function(t){this.updateModel({rewards:t})},t.prototype.rewardOnPositionGet=function(t){return t&&this.model.rewards.find((function(e){var n=e.x,i=e.y;return n===t.x&&i===t.y}))},t.findButtons=function(t){return new s.default(t)},t}();e.default=u},765:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=["up","right","down","left"],i=function(){function t(t){var e=this;this.buttons={};for(var i=function(n){var i=t(n);o.buttons[n]=i,i.addEventListener("click",(function(){var t;return null===(t=e.onClick)||void 0===t?void 0:t.call(e,n)}))},o=this,r=0,a=n;r<a.length;r++)i(a[r]);this.disableAll()}return t.prototype.disableAll=function(){for(var t=0,e=n;t<e.length;t++){var i=e[t];this.buttons[i].disabled=!0}},t.prototype.update=function(t){for(var e=t.possibleSteps(),i=0,o=n;i<o.length;i++){var r=o[i];this.buttons[r].disabled=!e[r]}},t}();e.default=i},570:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(601),o=function(){function t(t,e){if("number"!=typeof t||isNaN(t)||"number"!=typeof e||isNaN(e))throw new Error("en.Position.invalid");this.x=t,this.y=e,Object.freeze(this)}return t.parse=function(e){if(!e)return null;try{return new t(e.x,e.y)}catch(t){return console.error("D3O_RewardBoard invalid position:",e),console.error(t),null}},t.prototype.toCoords=function(){return{x:this.x,y:this.y}},t.prototype.distance=function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},t.prototype.isOnBoard=function(){var t=0===this.x,e=0===this.y;if(t&&e)return!0;var n=Math.abs(this.x),o=Math.abs(this.y);if(t||e)return(t?o:n)<=i.RIMS_LEVELS*i.RIM_STEPS-i.RIM_STEPS+i.RIM_LAS_LEVEL_STEPS;if(n%i.RIM_STEPS==0||o%i.RIM_STEPS==0){var r=[n,o].sort((function(t,e){return t-e})),a=r[0],s=r[1],u=s%i.RIM_STEPS==0,l=u?s/i.RIM_STEPS:a/i.RIM_STEPS;return!(l>i.RIMS_LEVELS)&&(u?a:s)<=l*i.RIM_STEPS}return!1},t.prototype.possibleSteps=function(){return{up:this.step("up").isOnBoard(),right:this.step("right").isOnBoard(),down:this.step("down").isOnBoard(),left:this.step("left").isOnBoard()}},t.prototype.step=function(e){switch(e){case"up":return new t(this.x,this.y-1);case"right":return new t(this.x+1,this.y);case"down":return new t(this.x,this.y+1);case"left":return new t(this.x-1,this.y)}},t}();e.default=o},948:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){this.content=t.content.cloneNode(!0)}return t.prototype.set=function(t,e,n){var i=this.content.querySelector('[data-value="'+t+'"]');i&&(i.textContent=e,n&&n(i))},t.prototype.insertInto=function(t){t.innerHTML="",t.appendChild(this.content)},t}();e.default=n},450:function(t,e,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var r=n(601),a=o(n(570)),s=o(n(96)),u={slot:2.76,stepMargin:0,step:2.76,stepBorder:2.3/10},l={thick:2,headRadius:7,headY:-7,pathTopY:-1,pathBottomY:14,path1x:-3,path2x:-10,path3x:11,path4x:3},c=function(){function t(t){var e=this;this.mouseOverPosition=null,this.canvasCtx=null,this.currentModel=null,this.currentSizes=null,this.onPositionClick=function(t){t.stopPropagation();var n=y(e,t);(null==n?void 0:n.isOnBoard())&&e.onPositionClickCallback(n)},this.onMouseMove=s.default((function(t){var n=e.mouseOverPosition;t.stopPropagation();var i=y(e,t);null!==i&&(i.isOnBoard()?(null==n?void 0:n.x)===i.x&&(null==n?void 0:n.y)===i.y||(e.mouseOverPosition=i):e.mouseOverPosition=null,n!==e.mouseOverPosition&&e.onMouseMoveCallback(e.mouseOverPosition||void 0))}),400),this.onPositionClickCallback=t.onPositionClick,this.onMouseMoveCallback=t.onMouseMove,this.wrapper=document.createElement("div"),this.wrapper.classList.add("wrapper"),this.canvas=document.createElement("canvas"),this.resetCanvas(0),this.canvas.addEventListener("mousemove",this.onMouseMove),this.canvas.addEventListener("click",this.onPositionClick),this.wrapper.appendChild(this.canvas)}return t.prototype.attach=function(t){t.appendChild(this.wrapper)},t.prototype.render=function(t){this.currentModel=t,t.viewSize===this.canvas.width&&t.viewSize===this.canvas.height||this.resetCanvas(t.viewSize);var e=this.canvasCtx;if(null!==e){e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.viewSize,t.viewSize),this.currentSizes=i({view:t.viewSize},v(u,t.viewSize));for(var n=0,o=t.rewards;n<o.length;n++)h(e,o[n],this.currentSizes);t.avatarPosition&&function(t,e,n,i){var o=n.slot,r=d(e,n),a=r[0],s=r[1],u=v(l,o,40,!1);t.lineWidth=u.thick,t.strokeStyle="black",t.setTransform(1,0,0,1,a+.5,s+.5),t.beginPath(),t.ellipse(0,u.headY,u.headRadius,u.headRadius,0,0,2*Math.PI),t.fillStyle=i,t.moveTo(u.path1x,u.pathTopY),t.lineTo(u.path2x,u.pathBottomY),t.lineTo(u.path3x,u.pathBottomY),t.lineTo(u.path4x,u.pathTopY),t.fill(),t.stroke()}(e,t.avatarPosition,this.currentSizes,t.avatarColor),e.lineWidth=this.currentSizes.stepBorder,e.strokeStyle="black";for(var a=0,s=r.mapTiles;a<s.length;a++)f(e,s[a],this.currentSizes)}},t.prototype.resetCanvas=function(t){this.canvas.width=t,this.canvas.height=t,this.canvasCtx=this.canvas.getContext("2d"),null!==this.canvasCtx&&(this.canvasCtx.imageSmoothingEnabled=!1)},t}();function f(t,e,n){var i=n.slot,o=n.stepMargin,r=n.step,a=d(e,n),s=a[0],u=a[1];t.setTransform(1,0,0,1,s-Math.floor(i/2),u-Math.floor(i/2)),t.strokeRect(o,o,r,r)}function h(t,e,n){var i=n.step,o=n.stepMargin,r=n.slot,a=d(e,n),s=a[0],u=a[1];t.fillStyle=e.color,t.setTransform(1,0,0,1,s,u);var l=Math.floor(r/2);t.fillRect(o-l,o-l,i,i);var c=Math.floor(.8*r);t.font="bold "+c+"px sans",t.fillStyle="black";var f=e.label;t.fillText(f,-t.measureText(f).width/2,.35*c)}function d(t,e){var n=e.view,i=e.slot;return[n/2+t.x*i,n/2+t.y*i]}function p(t,e,n){return t/n*e}function v(t,e,n,o){void 0===n&&(n=100),void 0===o&&(o=!0),t=i({},t);for(var r=0,a=Object.keys(t);r<a.length;r++){var s=a[r],u=p(t[s],e,n);t[s]=o?Math.round(u):u}return t}function y(t,e){if(!t.currentModel||!t.currentSizes)return null;var n=t.currentSizes.slot,i=t.currentModel.viewSize/2,o=t.canvas.getBoundingClientRect(),r=Math.floor((e.clientX-o.x-i+n/2)/t.currentSizes.slot),s=Math.floor((e.clientY-o.y-i+n/2)/t.currentSizes.slot);return new a.default(r,s)}e.default=c},601:(t,e)=>{"use strict";function n(t,n){e.mapTiles.push({x:t,y:n})}Object.defineProperty(e,"__esModule",{value:!0}),e.mapTiles=e.RIM_LAS_LEVEL_STEPS=e.RIM_STEPS=e.RIMS_LEVELS=void 0,e.RIMS_LEVELS=4,e.RIM_STEPS=3,e.RIM_LAS_LEVEL_STEPS=8,e.mapTiles=[],n(0,0);for(var i=e.RIMS_LEVELS*e.RIM_STEPS+e.RIM_LAS_LEVEL_STEPS-e.RIM_STEPS,o=-i;o<=i;o+=1)0!==o&&(n(o,0),n(0,o));for(var r=0;r<e.RIMS_LEVELS;r+=1){var a=r*e.RIM_STEPS+e.RIM_STEPS;for(o=-a;o<a;o+=1)0!==o&&(n(o,-a),n(a,o),n(o,a),n(-a,o));n(a,-a),n(a,a),n(-a,a),n(-a,-a)}},276:function(t,e){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,r){function a(t){try{u(i.next(t))}catch(t){r(t)}}function s(t){try{u(i.throw(t))}catch(t){r(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((i=i.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.fetch=void 0,e.fetch=function(t,e){return i(this,void 0,void 0,(function(){var i;return o(this,(function(o){switch(o.label){case 0:i={method:(null==e?void 0:e.method)||"POST",credentials:"include",headers:n({"Content-Type":"application/json"},null==e?void 0:e.headers),body:(null==e?void 0:e.data)&&JSON.stringify(e.data)},o.label=1;case 1:return o.trys.push([1,4,,5]),[4,globalThis.fetch(t,i)];case 2:return[4,o.sent().json()];case 3:return[2,o.sent()];case 4:return o.sent(),[2,null];case 5:return[2]}}))}))}},629:function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=i(n(336)),r=n(276),a=i(n(948));globalThis.D3O_RewardBoard=function(t){try{t({Board:o.default,fetch:r.fetch,Template:a.default})}catch(t){console.error("D3O_RewardBoard failed",t)}}}},e={};function n(i){var o=e[i];if(void 0!==o)return o.exports;var r=e[i]={exports:{}};return t[i].call(r.exports,r,r.exports,n),r.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n(629)})();